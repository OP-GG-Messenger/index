<!doctype html>
<html lang="en" class="h-100">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Join Peep</title>

  <script>
    const API_ENDPOINT = 'https://13.125.190.27:90';

    function getRoomId() {
      return location.search.replace(/^\?/, '');
    }
    function confirmOpenInPeep() {
      const room_id = getRoomId();
      if (confirm('Open in peep ' + room_id + '?')) {
        openInPeep()
      }
    }

    function openInPeep() {
      const room_id = getRoomId();
      const link = 'peep://join/' + room_id;
      location.href = link;
    }

    async function onLoad() {
      const room_id = getRoomId();

      // try {
      //   const response = await fetch(`${API_ENDPOINT}/roomInfo/${room_id}`, {
      //     headers: { 'Content-Type': 'application/json' },
      //     method: 'GET',
      //   });

      //   const responseJson = await response.json();
      //   document.getElementById("join-room").style.display = 'block';
      //   document.getElementById("room-name").innerText = responseJson.roomInfo.name;
      //   document.getElementById("user-count").innerText = responseJson.roomInfo.userCount;

      //   document.getElementById("cover").style.display = 'flex';
      // } catch (e) {
      //   document.getElementById("join-room").style.display = 'none';
      //   document.getElementById("error").style.display = 'block';

      //   document.getElementById("cover").style.display = 'flex';
      //   console.log('Fetch error', e);
      //   return null; // Failure
      // }

      document.getElementById("join-room").style.display = 'block';
      document.getElementById("cover").style.display = 'flex';
    }
  </script>


  <!-- Bootstrap core CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">

  <style>
    .bd-placeholder-img {
      font-size: 1.125rem;
      text-anchor: middle;
      -webkit-user-select: none;
      -moz-user-select: none;
      user-select: none;
    }

    @media (min-width: 768px) {
      .bd-placeholder-img-lg {
        font-size: 3.5rem;
      }
    }
  </style>


  <!-- Custom styles for this template -->
  <link href="cover.css" rel="stylesheet">
</head>

<body onload="onLoad()" class="d-flex flex-column h-100 text-white">
  <div id="cover" class="cover-container">
    <img class="logo" src="resources/ui-logo-symbol-typo.svg" alt="logo">
    <div id="join-room">
      <div class="room-info">
        <span id="room-name" class="room-info__name" title="title">You are invited to the room</span>
        <!-- <div class="user-count">
          <img class="user-count__icon" src="resources/icon-small-person.svg" alt="user-count">
          <span id="user-count" class="user-count__text"></span>
        </div> -->
      </div>
      <button class="enter-button" onclick="openInPeep()">
        <img class="enter-button__icon" src="resources/icon-joinroom.svg" alt="join-room">
        <span class="enter-button__text">Join Room</span>
      </button>
      <div class="download">
        <span class="text">If you havenâ€™t installed PEEP yet, </span>
        <a class="text text--link" target="_blank"
          href="https://peep-team.notion.site/PEEP-Alpha-Download-KR-dc7cb55a00b0488b96095cbf231245c2">Download Now</a>
      </div>
    </div>
    <div id="error">
      <div class="text text-center">Invalid invite link</div>
      <div class="mt-3">
        <a class="text text--link" target="_blank" href="https://peep.lol">Go back to PEEP</a>
      </div>
    </div>
  </div>
</body>

</html>